(function(global,factory){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global):function(w){if(!w.document){throw new Error("Sleuth requires a window with a document")}return factory(w)}}else{factory(global)}}(typeof window!=="undefined"?window:this,function(window){var Sleuth=function(args,context){this._init()};Sleuth.prototype={constructor:Sleuth,_init:function(){this.headNode=document.getElementsByTagName("HEAD").item(0);this.refMapping=mappingExport();this.numRef=0},require:function(aliass,fn){var i,me=this,timer,timeCounter=0,defaultTimeout=5000;if(aliass instanceof Array){var len=aliass.length;for(i=0;i<len;i++){this._loadScript(aliass[i])}}else{if(typeof aliass=="string"){this._loadScript(aliass)}else{console.error("Sleuth error:the first parameter must be array or string")}}if(fn&&typeof fn=="function"){if(!define.amd){window.onload=function(){fn()}}else{timer=setInterval(function(){timeCounter+=100;if(len==me.numRef||timeCounter==defaultTimeout){fn();clearInterval(timer)}},100)}}else{if(fn){console.error("Sleuth error:the second parameter must be function")}}},_loadScript:function(filePath){var scriptNode=document.createElement("script"),module="",version="",me=this;var array=filePath.split("|");module=array[0];version=array.length>1?array[1]:"";scriptNode.type="text/javascript";scriptNode.onload=function(){me.numRef++};scriptNode.onerror=function(){me.numRef++;console.log("Sleuth error:"+module+" load failed")};scriptNode.onreadystatechange=function(){if(/loaded|complete/.test(scriptNode.readyState)){me.numRef++}};var mapping=this.refMapping[module],i;this.headNode.appendChild(scriptNode);if(mapping){if(version==""){for(i in mapping){scriptNode.src=typeof mapping[i]=="string"?mapping[i]:mapping[i].u;break}}else{if(mapping[version]){scriptNode.src=mapping[version]}else{console.error("Sleuth error:sorry,the version you wanna load is not in config file,you can pull request to our github,thx")}}}else{console.error("Sleuth error:sorry,the module you wanna load is not in config file,you can pull request to our github,thx")}function _inlineCreateStyleNode(url){styleNode=document.createElement("link");styleNode.setAttribute("type","text/css");styleNode.setAttribute("rel","stylesheet");styleNode.setAttribute("href",url);me.headNode.appendChild(styleNode)}var mappingCSS=typeof mapping=="string"?mapping["css"]:mapping["css"].c,len;if(mappingCSS){if(mappingCSS instanceof Array){len=mappingCSS.length;for(i=0;i<len;i++){_inlineCreateStyleNode(mappingCSS[i])}}else{if(typeof mappingCSS=="string"){_inlineCreateStyleNode(mappingCSS)}}}}};var sleuth=window.Sleuth=new Sleuth();if(typeof define==="function"&&define.amd){define("sleuth",[],function(){return sleuth})}return sleuth}));